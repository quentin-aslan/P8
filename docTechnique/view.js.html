

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: view.js | Documentation Technique</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="width: 0px; height: 0px">
        
            <img src="img/toast-ui.png" width="100%" height="100%">
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Documentation Technique</a></h1>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
    <div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="Controller.html">Controller</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Controller_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Controller.html#_filter">_filter</a></li><li><a href="Controller.html#_updateCount">_updateCount</a></li><li><a href="Controller.html#_updateFilterState">_updateFilterState</a></li><li><a href="Controller.html#addItem">addItem</a></li><li><a href="Controller.html#editItem">editItem</a></li><li><a href="Controller.html#editItemCancel">editItemCancel</a></li><li><a href="Controller.html#editItemSave">editItemSave</a></li><li><a href="Controller.html#removeCompletedItems">removeCompletedItems</a></li><li><a href="Controller.html#removeItem">removeItem</a></li><li><a href="Controller.html#setView">setView</a></li><li><a href="Controller.html#showActive">showActive</a></li><li><a href="Controller.html#showAll">showAll</a></li><li><a href="Controller.html#showCompleted">showCompleted</a></li><li><a href="Controller.html#toggleAll">toggleAll</a></li><li><a href="Controller.html#toggleComplete">toggleComplete</a></li></ul></div></li><li><a href="Model.html">Model</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Model_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Model.html#create">create</a></li><li><a href="Model.html#getCount">getCount</a></li><li><a href="Model.html#read">read</a></li><li><a href="Model.html#remove">remove</a></li><li><a href="Model.html#removeAll">removeAll</a></li><li><a href="Model.html#update">update</a></li></ul></div></li><li><a href="Store.html">Store</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Store_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Store.html#drop">drop</a></li><li><a href="Store.html#find">find</a></li><li><a href="Store.html#findAll">findAll</a></li><li><a href="Store.html#remove">remove</a></li><li><a href="Store.html#save">save</a></li></ul></div></li><li><a href="Template.html">Template</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Template_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Template.html#clearCompletedButton">clearCompletedButton</a></li><li><a href="Template.html#itemCounter">itemCounter</a></li><li><a href="Template.html#show">show</a></li></ul></div></li><li><a href="Todo.html">Todo</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Todo_sub"></div></li><li><a href="View.html">View</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="View_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="View.html#_bindItemEditCancel">_bindItemEditCancel</a></li><li><a href="View.html#_bindItemEditDone">_bindItemEditDone</a></li><li><a href="View.html#_clearCompletedButton">_clearCompletedButton</a></li><li><a href="View.html#_editItem">_editItem</a></li><li><a href="View.html#_editItemDone">_editItemDone</a></li><li><a href="View.html#_elementComplete">_elementComplete</a></li><li><a href="View.html#_itemId">_itemId</a></li><li><a href="View.html#_removeItem">_removeItem</a></li><li><a href="View.html#_setFilter">_setFilter</a></li><li><a href="View.html#bind">bind</a></li><li><a href="View.html#render">render</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Global</h3><ul><li><a href="global.html#$delegate">$delegate</a></li><li><a href="global.html#$on">$on</a></li><li><a href="global.html#$parent">$parent</a></li><li><a href="global.html#qs">qs</a></li><li><a href="global.html#qsa">qsa</a></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @desc Gére les intéractions avec le DOM et définit les valeurs par défaut du template.
 *
 * @constructor
 * @param {object} template Le template utilisé
 */
function View(template) {
	this.template = template;

	this.ENTER_KEY = 13;
	this.ESCAPE_KEY = 27;

	this.$todoList = qs('.todo-list');
	this.$todoItemCounter = qs('.todo-count');
	this.$clearCompleted = qs('.clear-completed');
	this.$main = qs('.main');
	this.$footer = qs('.footer');
	this.$toggleAll = qs('.toggle-all');
	this.$newTodo = qs('.new-todo');
}

/**
 * @desc Supprime une tâche
 * @param {Number} id Id de la tache à supprimer
 */
View.prototype._removeItem = function (id) {
	var elem = qs('[data-id="' + id + '"]');

	if (elem) {
		this.$todoList.removeChild(elem);
	}
};

/**
 * @desc Supprime toutes les tâches terminées
 * @param {Number} completedCount Nombre de tâches terminées
 * @param {Boolean} visible Le bouton est'il visible ou non ?
 */
View.prototype._clearCompletedButton = function (completedCount, visible) {
	this.$clearCompleted.innerHTML = this.template.clearCompletedButton(completedCount);
	this.$clearCompleted.style.display = visible ? 'block' : 'none';
};

/**
 * @desc Modifie le filtre de la page (Affiche toutes les tâche s/ Seulement les terminées / Seulement celle qui ne sont pas terminée)
 * @param {String} currentPage Page courante (active, completed)
 */
View.prototype._setFilter = function (currentPage) {
	qs('.filters .selected').className = '';
	qs('.filters [href="#/' + currentPage + '"]').className = 'selected';
};

/**
 * @desc Vérifie si une tâche est terminée ou non
 * @param {Number} id Id de la tâche
 * @param {Boolean} completed La tâche est terminée ou non ? 
 */
View.prototype._elementComplete = function (id, completed) {
	var listItem = qs('[data-id="' + id + '"]');

	if (!listItem) {
		return;
	}

	listItem.className = completed ? 'completed' : '';

	qs('input', listItem).checked = completed;
};

/**
 * @desc Modifie une tâche
 * @param {Number} id Id de la tâche
 * @param {String} title Titre de la tâche
 */
View.prototype._editItem = function (id, title) {
	var listItem = qs('[data-id="' + id + '"]');

	if (!listItem) {
		return;
	}

	listItem.className = listItem.className + ' editing';

	var input = document.createElement('input');
	input.className = 'edit';

	listItem.appendChild(input);
	input.focus();
	input.value = title;
};

/**
 * @desc Modifie le status d'une tâche en "terminée" (Modification terminé)
 * @param {Number} id Id de la tâche
 * @param {String} title Titre de la tâche
 */
View.prototype._editItemDone = function (id, title) {
	var listItem = qs('[data-id="' + id + '"]');

	if (!listItem) {
		return;
	}

	var input = qs('input.edit', listItem);
	listItem.removeChild(input);

	listItem.className = listItem.className.replace('editing', '');

	qsa('label', listItem).forEach(function (label) {
		label.textContent = title;
	});
};

/**
 * @description Renvoie toutes les tâches dans le DOM
 * @param {String} viewCmd Nom de la commande
 * @param {Object} parameter paramètres actifs
 */
View.prototype.render = function (viewCmd, parameter) {
	var self = this;
	var viewCommands = {
		showEntries: function () {
			self.$todoList.innerHTML = self.template.show(parameter);
		},
		removeItem: function () {
			self._removeItem(parameter);
		},
		updateElementCount: function () {
			self.$todoItemCounter.innerHTML = self.template.itemCounter(parameter);
		},
		clearCompletedButton: function () {
			self._clearCompletedButton(parameter.completed, parameter.visible);
		},
		contentBlockVisibility: function () {
			self.$main.style.display = self.$footer.style.display = parameter.visible ? 'block' : 'none';
		},
		toggleAll: function () {
			self.$toggleAll.checked = parameter.checked;
		},
		setFilter: function () {
			self._setFilter(parameter);
		},
		clearNewTodo: function () {
			self.$newTodo.value = '';
		},
		elementComplete: function () {
			self._elementComplete(parameter.id, parameter.completed);
		},
		editItem: function () {
			self._editItem(parameter.id, parameter.title);
		},
		editItemDone: function () {
			self._editItemDone(parameter.id, parameter.title);
		}
	};

	viewCommands[viewCmd]();
};

/**
 * @desc Récupère l'id d'une tâche
 * @param {Object} element Tâche 
 */
View.prototype._itemId = function (element) {
	var li = $parent(element, 'li');
	return parseInt(li.dataset.id, 10);
};

/**
 * @desc Décrit les actions à réaliser après la modification d'une tâche
 * @param {function} handler Fonction callback
 */
View.prototype._bindItemEditDone = function (handler) {
	var self = this;
	$delegate(self.$todoList, 'li .edit', 'blur', function () {
		if (!this.dataset.iscanceled) {
			handler({
				id: self._itemId(this),
				title: this.value
			});
		}
	});

	$delegate(self.$todoList, 'li .edit', 'keypress', function (event) {
		if (event.keyCode === self.ENTER_KEY) {
			this.blur();
		}
	});
};
/**
 * @desc Décrit les actions à réaliser lorsqu'une modification de tâche est annulé
 * @param {function} handler Fonction callback
 */
View.prototype._bindItemEditCancel = function (handler) {
	var self = this;
	$delegate(self.$todoList, 'li .edit', 'keyup', function (event) {
		if (event.keyCode === self.ESCAPE_KEY) {
			this.dataset.iscanceled = true;
			this.blur();

			handler({ id: self._itemId(this) });
		}
	});
};

/**
 * @desc Listeners sur les tâches, elles sont appelées en fonctions des actions de l'utilisateur
 * @param {string} event L'evenement réalisé
 * @param {function} handler Fonction callback
 */
View.prototype.bind = function (event, handler) {
	var self = this;
	if (event === 'newTodo') {
		$on(self.$newTodo, 'change', function () {
			handler(self.$newTodo.value);
		});

	} else if (event === 'removeCompleted') {
		$on(self.$clearCompleted, 'click', function () {
			handler();
		});

	} else if (event === 'toggleAll') {
		$on(self.$toggleAll, 'click', function () {
			handler({ completed: this.checked });
		});

	} else if (event === 'itemEdit') {
		$delegate(self.$todoList, 'li label', 'dblclick', function () {
			handler({ id: self._itemId(this) });
		});

	} else if (event === 'itemRemove') {
		$delegate(self.$todoList, '.destroy', 'click', function () {
			handler({ id: self._itemId(this) });
		});

	} else if (event === 'itemToggle') {
		$delegate(self.$todoList, '.toggle', 'click', function () {
			handler({
				id: self._itemId(this),
				completed: this.checked
			});
		});

	} else if (event === 'itemEditDone') {
		self._bindItemEditDone(handler);

	} else if (event === 'itemEditCancel') {
		self._bindItemEditCancel(handler);
	}
};

// Export to window
window.app = window.app || {};
window.app.View = View;</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="img/toast-ui.png" style="width: 0px; height: 0px">
    <div class="footer-text">P8 - Quentin Aslan</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
